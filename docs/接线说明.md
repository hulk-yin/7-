# ESP32智能环境监控与语音助手 - 接线说明

## 总体接线图

```
                  +-----------------+
                  |                 |
                  |    ESP32-S      |
                  |    NodeMCU      |
                  |                 |
                  +-----------------+
                      |  |  |  |  |
         +------------+  |  |  |  +------------+
         |               |  |  |               |
         v               v  v  v               v
  +-----------+    +-----------+    +------------------+
  |  INMP441  |    | 0.91" OLED|    |   MAX98357A      |
  | 麦克风模块 |    | 显示模块  |    |  扬声器驱动模块  |
  +-----------+    +-----------+    +------------------+
                                            |
                                            v
                                     +-------------+
                                     |   扬声器    |
                                     +-------------+
```

## 详细接线说明

### 1. INMP441麦克风模块接线

INMP441是一个I2S数字麦克风模块，需要连接到ESP32的I2S接口。

| INMP441引脚 | ESP32引脚 | 说明 |
|------------|-----------|------|
| VDD        | 3.3V      | 电源正极 |
| GND        | GND       | 电源地 |
| SD         | GPIO33    | I2S数据线 |
| L/R        | GND       | 左/右声道选择，接地为左声道 |
| WS         | GPIO25    | Word Select/LRCLK (左右声道时钟) |
| SCK        | GPIO32    | Serial Clock/BCLK (位时钟) |

### 2. MAX98357A扬声器模块接线

MAX98357A是I2S接口的音频放大器模块，连接扬声器输出音频。

| MAX98357A引脚 | ESP32引脚 | 说明 |
|--------------|-----------|------|
| VIN          | 5V        | 电源正极，建议使用5V |
| GND          | GND       | 电源地 |
| DIN          | GPIO14    | I2S数据输入 |
| BCLK         | GPIO26    | 位时钟 |
| LRC          | GPIO27    | 左右声道时钟 |
| SD           | 3.3V/NC   | 静音控制，高电平或悬空为启用 |
| GAIN         | 按需设置   | 增益设置，请参考模块说明 |

### 3. 0.91寸OLED显示屏接线

这是一个I2C接口的OLED显示屏，地址为0x3C。

| OLED引脚 | ESP32引脚 | 说明 |
|---------|-----------|------|
| VCC     | 3.3V      | 电源正极 |
| GND     | GND       | 电源地 |
| SCL     | GPIO22    | I2C时钟线 |
| SDA     | GPIO21    | I2C数据线 |

### 4. 电源连接

ESP32开发板可以通过USB供电或使用锂电池：

- **USB供电**：直接使用Micro USB/Type-C线连接电脑或适配器
- **锂电池供电**：
  - 如果开发板带有电池接口，直接连接锂电池
  - 如使用外部电池，需要通过电池保护板连接到ESP32的5V和GND引脚

## 注意事项

1. **电源管理**：
   - 确保所有模块共用同一个GND参考点
   - 麦克风和OLED使用3.3V供电，扬声器模块推荐使用5V供电
   - 如果同时使用多个模块，确保电源能提供足够电流

2. **I2S时钟设置**：
   - 麦克风和扬声器使用不同的I2S控制器，避免引脚冲突
   - 软件中需要正确配置每个I2S设备的时钟频率和格式

3. **噪声处理**：
   - 扬声器和麦克风的连接线尽量分开布置，避免干扰
   - 可以在电源线上添加去耦电容，减少噪声

4. **调试技巧**：
   - 首先逐个测试各个模块的基本功能
   - 出现问题时先检查接线，再检查软件配置
   - 可使用万用表检查供电电压是否正常

## 组装步骤

1. 在连接任何组件前，确保ESP32未供电
2. 按照上述表格连接INMP441麦克风模块
3. 连接MAX98357A扬声器模块，并将扬声器接到模块输出端
4. 连接OLED显示屏
5. 最后连接电源，优先使用USB供电进行测试
6. 上电后，使用基本测试程序验证各个组件功能

## 扩展模块接线（可选）

如需添加温湿度传感器等扩展模块，可参考以下接线建议：

### DHT22/AM2302温湿度传感器

| DHT22引脚 | ESP32引脚 | 说明 |
|----------|-----------|------|
| VCC      | 3.3V      | 电源正极 |
| DATA     | GPIO17    | 数据线，需上拉电阻(4.7kΩ至10kΩ) |
| GND      | GND       | 电源地 |
