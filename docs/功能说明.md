# ESP32智能环境监控与语音助手 - 功能说明文档

## 1. 硬件规格

### 1.1 核心组件
- 主控:NODEMCU  ESP32S 开发板  
- 音频输入: 麦克风模块INMP441 I2S 、
- 音频输出：扬声器模块MAX98357A I2S， 
- 显示: 0.91 IIC OLED 128x32

### 1.2 接口定义 

#### GPIO接口定义
- **I2S音频输入(INMP441麦克风)**
  - GPIO32: I2S BCLK (位时钟)
  - GPIO25: I2S LRCLK (左右声道时钟)
  - GPIO33: I2S DATA (数据输入)
  - GND: 接地
  - VDD: 3.3V电源

- **I2S音频输出(MAX98357A扬声器)**
  - GPIO26: I2S BCLK (位时钟)
  - GPIO27: I2S LRCLK (左右声道时钟)
  - GPIO14: I2S DATA (数据输出)
  - GND: 接地
  - VIN: 5V电源
  - SD: 3.3V或NC (静音控制，高电平启用)

- **I2C显示屏(0.91寸OLED)**
  - GPIO21: SDA (数据线)
  - GPIO22: SCL (时钟线)
  - GND: 接地
  - VCC: 3.3V电源
  - 设备地址: 0x3C

#### ADC接口

### 3.1 语音唤醒
- **唤醒词**: "你好ESP32"
- **唤醒反馈**: LED指示灯亮起，发出提示音
- **误唤醒控制**: 支持调整灵敏度

### 3.2 语音识别(ASR)
- **识别引擎**: 讯飞云端语音识别服务
- **支持语言**: 中文(普通话)
- **识别模式**: 唤醒后8秒自动录音识别
- **命令识别**: 支持预设指令和自然语言处理

### 3.3 语音合成(TTS)
- **合成引擎**: 讯飞云端语音合成服务
- **语音特点**: 可配置音色、语速、音调
- **交互场景**: 指令反馈、查询结果播报

### 3.4 语音控制
- **系统控制**: 查询温湿度、切换模式等
- **设置调整**: 修改阈值、调整音量等
- **智能家居**: 预留与其他智能设备联动接口

## 4. AI助手功能

### 4.1 大模型接入
- **AI引擎**: 讯飞星火认知大模型
- **接入方式**: WebSocket API
- **交互方式**: 语音对话、文本输入
- **响应时间**: 平均<2秒(WiFi环境下)

### 4.2 智能对话
- **通用问答**: 支持百科、新闻、天气等查询
- **上下文理解**: 支持多轮对话上下文保持
- **个性化回答**: 根据用户画像优化回答

### 4.3 场景应用
- **天气查询**: "今天天气怎么样"
- **温湿度查询**: "现在室内温度是多少"
- **智能建议**: 根据温湿度提供舒适度建议

## 5. 网络连接功能

### 5.1 WiFi连接
- **配网方式**: SmartConfig/AP模式/蓝牙配网
- **协议支持**: 802.11 b/g/n (2.4GHz)
- **连接管理**: 自动重连、信号强度监测

### 5.2 WebSocket通信
- **服务对接**: ASR/TTS/AI大模型服务
- **数据格式**: JSON格式数据交换
- **安全机制**: SSL加密、Token认证

### 5.3 OTA升级
- **升级方式**: WiFi空中升级
- **升级策略**: 增量更新、版本检测
- **安全保障**: 签名验证、MD5校验

## 6. 蓝牙功能

### 6.1 BLE广播
- **广播内容**: 设备ID、温湿度数据、电量
- **广播间隔**: 可配置(默认5秒)
- **可发现性**: 支持自定义设备名称

### 6.2 手机APP连接
- **配对方式**: 无需PIN码、扫码配对
- **数据交互**: 双向通信，支持读写特征值
- **应用场景**: 设备配置、数据查看、固件升级

## 7. 低功耗管理

### 7.1 电源管理
- **供电方式**: 锂电池/USB双供电
- **电池监测**: 实时监测电池电量
- **低电提醒**: 电量低于20%时提醒

### 7.2 休眠策略
- **浅度休眠**: 网络保持，传感器定时唤醒
- **深度休眠**: 仅按键唤醒，最大省电模式
- **智能休眠**: 根据使用场景自动切换模式

### 7.3 功耗优化
- **运行模式**: 50mA(平均)
- **浅睡模式**: 20mA
- **深睡模式**: <1mA
- **预期电池寿命**: 2000mAh电池可持续工作>48小时

## 8. 开发与扩展

### 8.1 开发接口
- **API文档**: 详细HTTP API和BLE接口说明
- **二次开发**: 提供功能扩展指南
- **示例代码**: 各功能模块调用示例

### 8.2 扩展功能
- **传感器扩展**: 预留I2C/SPI接口支持更多传感器
- **控制扩展**: 继电器控制、红外遥控等
- **显示扩展**: 支持多种显示屏接入

## 9. 应用场景

### 9.1 智能家居
- 室内环境监测与语音控制中心
- 智能家电语音控制中枢
- 家庭智能助手

### 9.2 商业应用
- 办公环境监测与管理
- 仓储环境监控预警
- 会议室智能助手

### 9.3 教育科研
- 物联网开发教学平台
- 环境数据采集终端
- 人工智能语音交互演示
